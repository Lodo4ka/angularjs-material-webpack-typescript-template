<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Angular Material style sheet -->
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.12/angular-material.min.css" />
</head>

<body ng-app="BlankApp" ng-cloak>
    <div ng-controller="myCtrl">
        <mc-dates date-from="‘$ctrl.date1’" date-to="‘$ctrl.date2’" mcchange="cb()"></mc-dates>
        <div>
            <md-input-container>
                <label>Дата 1</label>
                <input ng-change="changeInput()" ng-model="date1" />
            </md-input-container>
            <md-input-container>
                <label>Дата 2</label>
                <input ng-change="changeInput()" ng-model="date2" />
            </md-input-container>
        </div>
    </div>
    <!-- Angular Material requires Angular.js Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular-animate.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular-aria.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular-messages.min.js"></script>
    <!-- Angular Material Library -->
    <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.12/angular-material.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
    <!-- Your application bootstrap  -->
    <script type="text/javascript">
        /**
         * You must include the dependency on 'ngMaterial'
         */
        const app = angular
            .module('BlankApp', ['ngMaterial', 'ngMessages'])
            .config($mdDateLocaleProvider => {
                /**
                 * @param date {Date}
                 * @returns {string} string representation of the provided date
                 */
                $mdDateLocaleProvider.formatDate = function(date) {
                    return date ? moment(date).format('YYYY-MM-DD') : '';
                };
                /**
                 * @param dateString {string} string that can be converted to a Date
                 * @returns {Date} JavaScript Date object created from the provided dateString
                 */
                $mdDateLocaleProvider.parseDate = function(dateString) {
                    var m = moment(dateString, 'YYYY-MM-DD', true);
                    return m.isValid() ? m.toDate() : new Date(NaN);
                };
            });

        app.controller('myCtrl', ($scope, $log, $filter, $parse) => {
            $scope.date1 = moment().format('YYYY-MM-DD');
            $scope.date2 = moment().format('YYYY-MM-DD');
            $scope.cb = () => {};
            $scope.changeInput = () => {
                $scope.$broadcast('changeInput');
            };
        });

        app.directive('mcDates', $parse => {
            return {
                templateUrl: './mc-dates.html',
                link: ($scope, $element, $attrs) => {
                    $scope.$on('changeInput', () => {
                        $scope.cb();
                    });
                },
            };
        });
    </script>
</body>

</html>